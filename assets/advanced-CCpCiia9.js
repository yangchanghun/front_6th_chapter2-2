import{r as w,a as Z,j as e,R as je}from"./client-DvaAtPIX.js";import{i as se}from"./index-OpXCsImY.js";const M={},ne=(t,r)=>t.unstable_is?t.unstable_is(r):r===t,re=t=>"init"in t,U=t=>!!t.write,ie=t=>"v"in t||"e"in t,O=t=>{if("e"in t)throw t.e;if((M?"production":void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},B=new WeakMap,ae=t=>{var r;return W(t)&&!!((r=B.get(t))!=null&&r[0])},ve=t=>{const r=B.get(t);r?.[0]&&(r[0]=!1,r[1].forEach(n=>n()))},ue=(t,r)=>{let n=B.get(t);if(!n){n=[!0,new Set],B.set(t,n);const s=()=>{n[0]=!1};t.then(s,s)}n[1].add(r)},W=t=>typeof t?.then=="function",xe=(t,r,n)=>{n.p.has(t)||(n.p.add(t),r.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},G=(t,r,n)=>{const s=n(t),i="v"in s,a=s.v;if(W(r))for(const o of s.d.keys())xe(t,r,n(o));s.v=r,delete s.e,(!i||!Object.is(a,s.v))&&(++s.n,W(a)&&ve(a))},oe=(t,r,n)=>{var s;const i=new Set;for(const a of((s=n.get(t))==null?void 0:s.t)||[])n.has(a)&&i.add(a);for(const a of r.p)i.add(a);return i},we=Symbol(),Ne=(t=new WeakMap,r=new WeakMap,n=new WeakMap,s=new Set,i=new Set,a=new Set,o={},x=(l,...b)=>l.read(...b),u=(l,...b)=>l.write(...b),d=(l,b)=>{var j;return(j=l.unstable_onInit)==null?void 0:j.call(l,b)},p=(l,b)=>{var j;return(j=l.onMount)==null?void 0:j.call(l,b)},...g)=>{const l=g[0]||(c=>{if((M?"production":void 0)!=="production"&&!c)throw new Error("Atom is undefined or null");let v=t.get(c);return v||(v={d:new Map,p:new Set,n:0},t.set(c,v),d?.(c,T)),v}),b=g[1]||(()=>{const c=[],v=y=>{try{y()}catch(h){c.push(h)}};do{o.f&&v(o.f);const y=new Set,h=y.add.bind(y);s.forEach(m=>{var f;return(f=r.get(m))==null?void 0:f.l.forEach(h)}),s.clear(),a.forEach(h),a.clear(),i.forEach(h),i.clear(),y.forEach(v),s.size&&j()}while(s.size||a.size||i.size);if(c.length)throw new AggregateError(c)}),j=g[2]||(()=>{const c=[],v=new WeakSet,y=new WeakSet,h=Array.from(s);for(;h.length;){const m=h[h.length-1],f=l(m);if(y.has(m)){h.pop();continue}if(v.has(m)){if(n.get(m)===f.n)c.push([m,f]);else if((M?"production":void 0)!=="production"&&n.has(m))throw new Error("[Bug] invalidated atom exists");y.add(m),h.pop();continue}v.add(m);for(const N of oe(m,f,r))v.has(N)||h.push(N)}for(let m=c.length-1;m>=0;--m){const[f,N]=c[m];let C=!1;for(const E of N.d.keys())if(E!==f&&s.has(E)){C=!0;break}C&&(S(f),P(f)),n.delete(f)}}),S=g[3]||(c=>{var v;const y=l(c);if(ie(y)&&(r.has(c)&&n.get(c)!==y.n||Array.from(y.d).every(([k,R])=>S(k).n===R)))return y;y.d.clear();let h=!0;const m=()=>{r.has(c)&&(P(c),j(),b())},f=k=>{var R;if(ne(c,k)){const te=l(k);if(!ie(te))if(re(k))G(k,k.init,l);else throw new Error("no atom init");return O(te)}const J=S(k);try{return O(J)}finally{y.d.set(k,J.n),ae(y.v)&&xe(c,y.v,J),(R=r.get(k))==null||R.t.add(c),h||m()}};let N,C;const E={get signal(){return N||(N=new AbortController),N.signal},get setSelf(){return(M?"production":void 0)!=="production"&&!U(c)&&console.warn("setSelf function cannot be used with read-only atom"),!C&&U(c)&&(C=(...k)=>{if((M?"production":void 0)!=="production"&&h&&console.warn("setSelf function cannot be called in sync"),!h)try{return _(c,...k)}finally{j(),b()}}),C}},$=y.n;try{const k=x(c,f,E);return G(c,k,l),W(k)&&(ue(k,()=>N?.abort()),k.then(m,m)),y}catch(k){return delete y.v,y.e=k,++y.n,y}finally{h=!1,$!==y.n&&n.get(c)===$&&(n.set(c,y.n),s.add(c),(v=o.c)==null||v.call(o,c))}}),I=g[4]||(c=>{const v=[c];for(;v.length;){const y=v.pop(),h=l(y);for(const m of oe(y,h,r)){const f=l(m);n.set(m,f.n),v.push(m)}}}),_=g[5]||((c,...v)=>{let y=!0;const h=f=>O(S(f)),m=(f,...N)=>{var C;const E=l(f);try{if(ne(c,f)){if(!re(f))throw new Error("atom not writable");const $=E.n,k=N[0];G(f,k,l),P(f),$!==E.n&&(s.add(f),(C=o.c)==null||C.call(o,f),I(f));return}else return _(f,...N)}finally{y||(j(),b())}};try{return u(c,h,m,...v)}finally{y=!1}}),P=g[6]||(c=>{var v;const y=l(c),h=r.get(c);if(h&&!ae(y.v)){for(const[m,f]of y.d)if(!h.d.has(m)){const N=l(m);L(m).t.add(c),h.d.add(m),f!==N.n&&(s.add(m),(v=o.c)==null||v.call(o,m),I(m))}for(const m of h.d||[])if(!y.d.has(m)){h.d.delete(m);const f=D(m);f?.t.delete(c)}}}),L=g[7]||(c=>{var v;const y=l(c);let h=r.get(c);if(!h){S(c);for(const m of y.d.keys())L(m).t.add(c);if(h={l:new Set,d:new Set(y.d.keys()),t:new Set},r.set(c,h),(v=o.m)==null||v.call(o,c),U(c)){const m=()=>{let f=!0;const N=(...C)=>{try{return _(c,...C)}finally{f||(j(),b())}};try{const C=p(c,N);C&&(h.u=()=>{f=!0;try{C()}finally{f=!1}})}finally{f=!1}};i.add(m)}}return h}),D=g[8]||(c=>{var v;const y=l(c);let h=r.get(c);if(h&&!h.l.size&&!Array.from(h.t).some(m=>{var f;return(f=r.get(m))==null?void 0:f.d.has(c)})){h.u&&a.add(h.u),h=void 0,r.delete(c),(v=o.u)==null||v.call(o,c);for(const m of y.d.keys()){const f=D(m);f?.t.delete(c)}return}return h}),V=[t,r,n,s,i,a,o,x,u,d,p,l,b,j,S,I,_,P,L,D],T={get:c=>O(S(c)),set:(c,...v)=>{try{return _(c,...v)}finally{j(),b()}},sub:(c,v)=>{const h=L(c).l;return h.add(v),b(),()=>{h.delete(v),D(c),b()}}};return Object.defineProperty(T,we,{value:V}),T},Se=Ne,le=ue,he={};let ke=0;function H(t,r){const n=`atom${++ke}`,s={toString(){return(he?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?s.read=t:(s.init=t,s.read=Ce,s.write=_e),s}function Ce(t){return t(this)}function _e(t,r,n){return r(this,typeof n=="function"?n(t(this)):n)}function me(){return Se()}let A;function Le(){return A||(A=me(),(he?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=A),globalThis.__JOTAI_DEFAULT_STORE__!==A&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),A}const Te={},fe=w.createContext(void 0);function ge(t){return w.useContext(fe)||Le()}function pe({children:t,store:r}){const n=w.useRef(void 0);return!r&&!n.current&&(n.current=me()),w.createElement(fe.Provider,{value:r||n.current},t)}const Q=t=>typeof t?.then=="function",X=t=>{t.status||(t.status="pending",t.then(r=>{t.status="fulfilled",t.value=r},r=>{t.status="rejected",t.reason=r}))},Ee=Z.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(X(t),t)}),K=new WeakMap,ce=(t,r)=>{let n=K.get(t);return n||(n=new Promise((s,i)=>{let a=t;const o=d=>p=>{a===d&&s(p)},x=d=>p=>{a===d&&i(p)},u=()=>{try{const d=r();Q(d)?(K.set(d,n),a=d,d.then(o(d),x(d)),le(d,u)):s(d)}catch(d){i(d)}};t.then(o(t),x(t)),le(t,u)}),K.set(t,n)),n};function F(t,r){const{delay:n,unstable_promiseStatus:s=!Z.use}={},i=ge(),[[a,o,x],u]=w.useReducer(p=>{const g=i.get(t);return Object.is(p[0],g)&&p[1]===i&&p[2]===t?p:[g,i,t]},void 0,()=>[i.get(t),i,t]);let d=a;if((o!==i||x!==t)&&(u(),d=i.get(t)),w.useEffect(()=>{const p=i.sub(t,()=>{if(s)try{const g=i.get(t);Q(g)&&X(ce(g,()=>i.get(t)))}catch{}if(typeof n=="number"){setTimeout(u,n);return}u()});return u(),p},[i,t,n,s]),w.useDebugValue(d),Q(d)){const p=ce(d,()=>i.get(t));return s&&X(p),Ee(p)}return d}function Pe(t,r){const n=ge();return w.useCallback((...i)=>{if((Te?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...i)},[n,t])}function z(t,r){return[F(t),Pe(t)]}const ye=H(!1);function De({searchTerm:t,setSearchTerm:r,cart:n,totalItemCount:s}){const[i,a]=z(ye);return e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!i&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:t,onChange:o=>r(o.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a(!i),className:`px-3 py-1.5 text-sm rounded transition-colors ${i?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:i?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!i&&e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),n.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:s})]})]})]})})})}const de=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],Ie=()=>{const t=localStorage.getItem("products");if(t)try{return JSON.parse(t)}catch{return de}return de},ee=H(Ie());function Ae({setShowProductForm:t,addNotification:r}){const[n,s]=w.useState(null),[i,a]=z(ee),[o,x]=w.useState({name:"",price:0,stock:0,description:"",discounts:[]}),u=l=>{s(l.id),x({name:l.name,price:l.price,stock:l.stock,description:l.description||"",discounts:l.discounts||[]}),t(!0)},d=(l,b)=>{a(j=>j.map(S=>S.id===l?{...S,...b}:S))},p=l=>{const b={...l,id:`p${Date.now()}`};a(j=>[...j,b])};return{startEditProduct:u,handleProductSubmit:l=>{l.preventDefault(),n&&n!=="new"?(d(n,o),s(null),r("상품이 수정되었습니다.","success")):(p({...o,discounts:o.discounts}),r("상품이 추가되었습니다.","success")),x({name:"",price:0,stock:0,description:"",discounts:[]}),s(null),t(!1)},productForm:o,setProductForm:x,editingProduct:n,setEditingProduct:s}}function Me(t,r,n,s,i){const[a,o]=w.useState(!1),[x,u]=w.useState({name:"",code:"",discountType:"amount",discountValue:0}),d=l=>{l.preventDefault(),p(x),u({name:"",code:"",discountType:"amount",discountValue:0}),o(!1)},p=w.useCallback(l=>{if(t.find(j=>j.code===l.code)){r("이미 존재하는 쿠폰 코드입니다.","error");return}n(j=>[...j,l]),r("쿠폰이 추가되었습니다.","success")},[t,r]),g=w.useCallback(l=>{n(b=>b.filter(j=>j.code!==l)),s?.code===l&&i(null),r("쿠폰이 삭제되었습니다.","success")},[s,r]);return{handleCouponSubmit:d,showCouponForm:a,setShowCouponForm:o,deleteCoupon:g,couponForm:x,setCouponForm:u}}function qe({setShowCouponForm:t,addNotification:r,handleCouponSubmit:n,couponForm:s,setCouponForm:i}){return e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>i({...s,name:a.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:s.code,onChange:a=>i({...s,code:a.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:s.discountType,onChange:a=>i({...s,discountType:a.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:s.discountValue===0?"":s.discountValue,onChange:a=>{const{value:o}=a.target;(o===""||/^\d+$/.test(o))&&i({...s,discountValue:o===""?0:parseInt(o)})},onBlur:a=>{const o=parseInt(a.target.value)||0;s.discountType==="percentage"?o>100?(r("할인율은 100%를 초과할 수 없습니다","error"),i({...s,discountValue:100})):o<0&&i({...s,discountValue:0}):o>1e5?(r("할인 금액은 100,000원을 초과할 수 없습니다","error"),i({...s,discountValue:1e5})):o<0&&i({...s,discountValue:0})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:s.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})}function Ve({coupons:t,addNotification:r,setCoupons:n,selectedCoupon:s,setSelectedCoupon:i}){const{deleteCoupon:a,showCouponForm:o,setShowCouponForm:x,handleCouponSubmit:u,setCouponForm:d,couponForm:p}=Me(t,r,n,s,i);return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[t.map(g=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:g.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:g.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:g.discountType==="amount"?`${g.discountValue.toLocaleString()}원 할인`:`${g.discountValue}% 할인`})})]}),e.jsx("button",{onClick:()=>a(g.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},g.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:()=>x(!o),className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),o&&e.jsx(qe,{addNotification:r,setShowCouponForm:x,handleCouponSubmit:u,setCouponForm:d,couponForm:p})]})]})}function $e({editingProduct:t,setEditingProduct:r,handleProductSubmit:n,addNotification:s,setShowProductForm:i,productForm:a,setProductForm:o}){return e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:a.name,onChange:x=>o({...a,name:x.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:a.description,onChange:x=>o({...a,description:x.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:a.price===0?"":a.price,onChange:x=>{const{value:u}=x.target;(u===""||/^\d+$/.test(u))&&o({...a,price:u===""?0:parseInt(u)})},onBlur:x=>{const{value:u}=x.target;u===""?o({...a,price:0}):parseInt(u)<0&&(s("가격은 0보다 커야 합니다","error"),o({...a,price:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:a.stock===0?"":a.stock,onChange:x=>{const{value:u}=x.target;(u===""||/^\d+$/.test(u))&&o({...a,stock:u===""?0:parseInt(u)})},onBlur:x=>{const{value:u}=x.target;u===""?o({...a,stock:0}):parseInt(u)<0?(s("재고는 0보다 커야 합니다","error"),o({...a,stock:0})):parseInt(u)>9999&&(s("재고는 9999개를 초과할 수 없습니다","error"),o({...a,stock:9999}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[a.discounts.map((x,u)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:x.quantity,onChange:d=>{const p=[...a.discounts];p[u].quantity=parseInt(d.target.value)||0,o({...a,discounts:p})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:x.rate*100,onChange:d=>{const p=[...a.discounts];p[u].rate=(parseInt(d.target.value)||0)/100,o({...a,discounts:p})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>{const d=a.discounts.filter((p,g)=>g!==u);o({...a,discounts:d})},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},u)),e.jsx("button",{type:"button",onClick:()=>{o({...a,discounts:[...a.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{r(null),o({name:"",price:0,stock:0,description:"",discounts:[]}),i(!1)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:t==="new"?"추가":"수정"})]})]})})}function Re({addNotification:t,formatPrice:r,products:n,deleteProduct:s}){const[i,a]=w.useState(!1),{startEditProduct:o,handleProductSubmit:x,productForm:u,setProductForm:d,setEditingProduct:p,editingProduct:g}=Ae({addNotification:t,setShowProductForm:a});return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:()=>{p("new"),d({name:"",price:0,stock:0,description:"",discounts:[]}),a(!0)},className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:l.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r(l.price,l.id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l.stock>10?"bg-green-100 text-green-800":l.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[l.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:l.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>o(l),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>s(l.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},l.id))})]})}),i&&e.jsx($e,{editingProduct:g,setEditingProduct:p,addNotification:t,setShowProductForm:a,productForm:u,setProductForm:d,handleProductSubmit:x})]})}function Oe({setActiveTab:t,activeTab:r,products:n,formatPrice:s,addNotification:i,setCoupons:a,setSelectedCoupon:o,selectedCoupon:x,coupons:u,deleteProduct:d}){return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>t("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${r==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>t("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${r==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),r==="products"?e.jsx(Re,{addNotification:i,formatPrice:s,products:n,deleteProduct:d}):e.jsx(Ve,{coupons:u,addNotification:i,setCoupons:a,selectedCoupon:x,setSelectedCoupon:o})]})}function Be(t,r){return t.reduce((n,s)=>r>=s.quantity&&s.rate>n?s.rate:n,0)}function We(t,r){return r?Math.min(t+.05,.5):t}function ze(t,r){const n=Be(t.product.discounts,t.quantity);return We(n,r)}const be=(t,r)=>{const n=r.some(o=>o.quantity>=10),{price:s}=t.product,{quantity:i}=t,a=ze(t,n);return Math.round(s*i*(1-a))},q=(t,r)=>{const n=r.find(i=>i.product.id===t.id);return t.stock-(n?.quantity||0)},Y=(t,r)=>{let n=0,s=0;return t.forEach(i=>{const a=i.product.price*i.quantity;n+=a,s+=be(i,t)}),r&&(r.discountType==="amount"?s=Math.max(0,s-r.discountValue):s=Math.round(s*(1-r.discountValue/100))),{totalBeforeDiscount:Math.round(n),totalAfterDiscount:Math.round(s)}};function Je({cart:t,removeFromCart:r,updateQuantity:n}){return e.jsx("div",{className:"space-y-3",children:t.map(s=>{const i=be(s,t),a=s.product.price*s.quantity,o=i<a,x=o?Math.round((1-i/a)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:s.product.name}),e.jsx("button",{onClick:()=>r(s.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>n(s.product.id,s.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>n(s.product.id,s.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[o&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",x,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(i).toLocaleString(),"원"]})]})]})]},s.product.id)})})}function Ue({coupons:t,selectedCoupon:r,setSelectedCoupon:n,applyCoupon:s}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),t.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:r?.code||"",onChange:i=>{const a=t.find(o=>o.code===i.target.value);a?s(a):n(null)},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map(i=>e.jsxs("option",{value:i.code,children:[i.name," (",i.discountType==="amount"?`${i.discountValue.toLocaleString()}원`:`${i.discountValue}%`,")"]},i.code))]})]})}function Ge(){return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]})}function Ke({filteredProducts:t,products:r,searchProductName:n,addToCart:s,formatPrice:i,cart:a}){return e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",r.length,"개 상품"]})]}),t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',n,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(o=>{const x=q(o,a);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),o.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...o.discounts.map(u=>u.rate))*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:o.name}),o.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:o.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:i(o.price,o.id)}),o.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[o.discounts[0].quantity,"개 이상 구매시 할인"," ",o.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[x<=5&&x>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",x,"개 남음"]}),x>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",x,"개"]})]}),e.jsx("button",{onClick:()=>s(o),disabled:x<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${x<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:x<=0?"품절":"장바구니 담기"})]})]},o.id)})})]})}function Qe({products:t,filteredProducts:r,searchProductName:n,formatPrice:s,cart:i,coupons:a,selectedCoupon:o,setSelectedCoupon:x,completeOrder:u,setCart:d,addNotification:p,addToCart:g,applyCoupon:l,updateQuantity:b,removeFromCart:j}){const S=Y(i,o);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(Ke,{filteredProducts:r,products:t,searchProductName:n,addToCart:g,formatPrice:s,cart:i})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),i.length===0?e.jsx(Ge,{}):e.jsx(Je,{cart:i,addNotification:p,setCart:d,products:t,updateQuantity:b,removeFromCart:j})]}),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ue,{coupons:a,selectedCoupon:o,setSelectedCoupon:x,applyCoupon:l}),e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[S.totalBeforeDiscount.toLocaleString(),"원"]})]}),S.totalBeforeDiscount-S.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",(S.totalBeforeDiscount-S.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[S.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs("button",{onClick:u,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[S.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})]})]})})]})}function Xe({notifications:t,setNotifications:r}){return e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:t.map(n=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${n.type==="error"?"bg-red-600":n.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:n.message}),e.jsx("button",{onClick:()=>r(s=>s.filter(i=>i.id!==n.id)),className:"text-white hover:text-gray-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},n.id))})}const Ye=()=>{const t=localStorage.getItem("cart");if(t)try{return JSON.parse(t)}catch{return[]}return[]},Ze=H(Ye());function He(t){const r=F(ee),[n,s]=z(Ze),[i,a]=w.useState(0),o=w.useCallback(d=>{if(q(d,n)<=0){t("재고가 부족합니다!","error");return}s(g=>{const l=g.find(b=>b.product.id===d.id);if(l){const b=l.quantity+1;return b>d.stock?(t(`재고는 ${d.stock}개까지만 있습니다.`,"error"),g):g.map(j=>j.product.id===d.id?{...j,quantity:b}:j)}return[...g,{product:d,quantity:1}]}),t("장바구니에 담았습니다","success")},[n,t,q]),x=w.useCallback(d=>{s(p=>p.filter(g=>g.product.id!==d))},[]),u=w.useCallback((d,p)=>{if(p<=0){x(d);return}const g=r.find(b=>b.id===d);if(!g)return;const l=g.stock;if(p>l){t(`재고는 ${l}개까지만 있습니다.`,"error");return}s(b=>b.map(j=>j.product.id===d?{...j,quantity:p}:j))},[r,x,t,q]);return w.useEffect(()=>{const d=n.reduce((p,g)=>p+g.quantity,0);a(d)},[n]),w.useEffect(()=>{n.length>0?localStorage.setItem("cart",JSON.stringify(n)):localStorage.removeItem("cart")},[n]),{cart:n,setCart:s,totalItemCount:i,addToCart:o,updateQuantity:u,removeFromCart:x}}function Fe(t,r){const[n,s]=w.useState(()=>{const u=localStorage.getItem("coupons");if(u)try{return JSON.parse(u)}catch{return se}return se}),[i,a]=w.useState(null);w.useEffect(()=>{localStorage.setItem("coupons",JSON.stringify(n))},[n]);const o=w.useCallback(u=>{if(Y(t,i).totalAfterDiscount<1e4&&u.discountType==="percentage"){r("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.","error");return}a(u),r("쿠폰이 적용되었습니다.","success")},[r,Y]),x=w.useCallback(u=>{s(d=>d.filter(p=>p.code!==u)),i?.code===u&&a(null),r("쿠폰이 삭제되었습니다.","success")},[i,r]);return{coupons:n,setCoupons:s,setSelectedCoupon:a,selectedCoupon:i,applyCoupon:o,deleteCoupon:x}}function et(){const[t,r]=z(ee);return w.useEffect(()=>{localStorage.setItem("products",JSON.stringify(t))},[t]),{products:t,setProducts:r,deleteProduct:s=>{r(i=>i.filter(a=>a.id!==s))}}}function tt(t,r){if(!r)return t;const n=r.toLowerCase();return t.filter(s=>s.name.toLowerCase().includes(n)||s.description&&s.description.toLowerCase().includes(n))}const st=()=>{const{products:t,deleteProduct:r}=et(),n=F(ye),[s,i]=w.useState([]),[a,o]=w.useState("products"),[x,u]=w.useState(""),[d,p]=w.useState(""),g=(h,m)=>{if(m){const f=t.find(N=>N.id===m);if(f&&q(f,b)<=0)return"SOLD OUT"}return n?`${h.toLocaleString()}원`:`₩${h.toLocaleString()}`},l=w.useCallback((h,m="success")=>{const f=Date.now().toString();i(N=>[...N,{id:f,message:h,type:m}]),setTimeout(()=>{i(N=>N.filter(C=>C.id!==f))},3e3)},[]),{cart:b,setCart:j,totalItemCount:S,addToCart:I,removeFromCart:_,updateQuantity:P}=He(l),{coupons:L,setCoupons:D,selectedCoupon:V,setSelectedCoupon:T,applyCoupon:c}=Fe(b,l);w.useEffect(()=>{const h=setTimeout(()=>{p(x)},500);return()=>clearTimeout(h)},[x]);const v=w.useCallback(()=>{const h=`ORD-${Date.now()}`;l(`주문이 완료되었습니다. 주문번호: ${h}`,"success"),j([]),T(null)},[l]),y=tt(t,d);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.length>0&&e.jsx(Xe,{notifications:s,setNotifications:i}),e.jsx(De,{searchTerm:x,setSearchTerm:u,cart:b,totalItemCount:S}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:n?e.jsx(Oe,{setActiveTab:o,activeTab:a,products:t,formatPrice:g,addNotification:l,coupons:L,setCoupons:D,deleteProduct:r,setSelectedCoupon:T,selectedCoupon:V}):e.jsx(Qe,{products:t,filteredProducts:y,searchProductName:d,cart:b,formatPrice:g,coupons:L,selectedCoupon:V,setSelectedCoupon:T,completeOrder:v,setCart:j,addNotification:l,addToCart:I,applyCoupon:c,removeFromCart:_,updateQuantity:P})})]})},nt=()=>e.jsx(pe,{children:e.jsx(st,{})});je.createRoot(document.getElementById("root")).render(e.jsx(Z.StrictMode,{children:e.jsx(pe,{children:e.jsx(nt,{})})}));
