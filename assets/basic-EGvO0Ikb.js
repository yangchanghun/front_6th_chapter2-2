import{j as e,r as h,R as W,a as A}from"./client-DvaAtPIX.js";import{i as M,a as H}from"./index-OpXCsImY.js";function R({isAdmin:s,searchTerm:l,setSearchTerm:i,cart:t,totalItemCount:a,setIsAdmin:r}){return e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:l,onChange:n=>i(n.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>r(!s),className:`px-3 py-1.5 text-sm rounded transition-colors ${s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),t.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:a})]})]})]})})})}function z({setProducts:s,setShowProductForm:l,addNotification:i}){const[t,a]=h.useState(null),[r,n]=h.useState({name:"",price:0,stock:0,description:"",discounts:[]}),o=d=>{a(d.id),n({name:d.name,price:d.price,stock:d.stock,description:d.description||"",discounts:d.discounts||[]}),l(!0)},c=(d,p)=>{s(m=>m.map(g=>g.id===d?{...g,...p}:g))},x=d=>{const p={...d,id:`p${Date.now()}`};s(m=>[...m,p])};return{startEditProduct:o,handleProductSubmit:d=>{d.preventDefault(),t&&t!=="new"?(c(t,r),a(null),i("상품이 수정되었습니다.","success")):(x({...r,discounts:r.discounts}),i("상품이 추가되었습니다.","success")),n({name:"",price:0,stock:0,description:"",discounts:[]}),a(null),l(!1)},productForm:r,setProductForm:n,editingProduct:t,setEditingProduct:a}}function J(s,l,i,t,a){const[r,n]=h.useState(!1),[o,c]=h.useState({name:"",code:"",discountType:"amount",discountValue:0}),x=p=>{p.preventDefault(),u(o),c({name:"",code:"",discountType:"amount",discountValue:0}),n(!1)},u=h.useCallback(p=>{if(s.find(g=>g.code===p.code)){l("이미 존재하는 쿠폰 코드입니다.","error");return}i(g=>[...g,p]),l("쿠폰이 추가되었습니다.","success")},[s,l]),d=h.useCallback(p=>{i(m=>m.filter(g=>g.code!==p)),t?.code===p&&a(null),l("쿠폰이 삭제되었습니다.","success")},[t,l]);return{handleCouponSubmit:x,showCouponForm:r,setShowCouponForm:n,deleteCoupon:d,couponForm:o,setCouponForm:c}}function U({setShowCouponForm:s,addNotification:l,handleCouponSubmit:i,couponForm:t,setCouponForm:a}){return e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:t.name,onChange:r=>a({...t,name:r.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:t.code,onChange:r=>a({...t,code:r.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:t.discountType,onChange:r=>a({...t,discountType:r.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:t.discountValue===0?"":t.discountValue,onChange:r=>{const{value:n}=r.target;(n===""||/^\d+$/.test(n))&&a({...t,discountValue:n===""?0:parseInt(n)})},onBlur:r=>{const n=parseInt(r.target.value)||0;t.discountType==="percentage"?n>100?(l("할인율은 100%를 초과할 수 없습니다","error"),a({...t,discountValue:100})):n<0&&a({...t,discountValue:0}):n>1e5?(l("할인 금액은 100,000원을 초과할 수 없습니다","error"),a({...t,discountValue:1e5})):n<0&&a({...t,discountValue:0})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:t.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})}function _({coupons:s,addNotification:l,setCoupons:i,selectedCoupon:t,setSelectedCoupon:a}){const{deleteCoupon:r,showCouponForm:n,setShowCouponForm:o,handleCouponSubmit:c,setCouponForm:x,couponForm:u}=J(s,l,i,t,a);return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[s.map(d=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:d.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:d.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:d.discountType==="amount"?`${d.discountValue.toLocaleString()}원 할인`:`${d.discountValue}% 할인`})})]}),e.jsx("button",{onClick:()=>r(d.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},d.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:()=>o(!n),className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),n&&e.jsx(U,{addNotification:l,setShowCouponForm:o,handleCouponSubmit:c,setCouponForm:x,couponForm:u})]})]})}function G({editingProduct:s,setEditingProduct:l,handleProductSubmit:i,addNotification:t,setShowProductForm:a,productForm:r,setProductForm:n}){return e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:r.name,onChange:o=>n({...r,name:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:r.description,onChange:o=>n({...r,description:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:r.price===0?"":r.price,onChange:o=>{const{value:c}=o.target;(c===""||/^\d+$/.test(c))&&n({...r,price:c===""?0:parseInt(c)})},onBlur:o=>{const{value:c}=o.target;c===""?n({...r,price:0}):parseInt(c)<0&&(t("가격은 0보다 커야 합니다","error"),n({...r,price:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:r.stock===0?"":r.stock,onChange:o=>{const{value:c}=o.target;(c===""||/^\d+$/.test(c))&&n({...r,stock:c===""?0:parseInt(c)})},onBlur:o=>{const{value:c}=o.target;c===""?n({...r,stock:0}):parseInt(c)<0?(t("재고는 0보다 커야 합니다","error"),n({...r,stock:0})):parseInt(c)>9999&&(t("재고는 9999개를 초과할 수 없습니다","error"),n({...r,stock:9999}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[r.discounts.map((o,c)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:o.quantity,onChange:x=>{const u=[...r.discounts];u[c].quantity=parseInt(x.target.value)||0,n({...r,discounts:u})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:o.rate*100,onChange:x=>{const u=[...r.discounts];u[c].rate=(parseInt(x.target.value)||0)/100,n({...r,discounts:u})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>{const x=r.discounts.filter((u,d)=>d!==c);n({...r,discounts:x})},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},c)),e.jsx("button",{type:"button",onClick:()=>{n({...r,discounts:[...r.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{l(null),n({name:"",price:0,stock:0,description:"",discounts:[]}),a(!1)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:s==="new"?"추가":"수정"})]})]})})}function K({addNotification:s,formatPrice:l,setProducts:i,products:t,deleteProduct:a}){const[r,n]=h.useState(!1),{startEditProduct:o,handleProductSubmit:c,productForm:x,setProductForm:u,setEditingProduct:d,editingProduct:p}=z({addNotification:s,setProducts:i,setShowProductForm:n});return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:()=>{d("new"),u({name:"",price:0,stock:0,description:"",discounts:[]}),n(!0)},className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:m.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l(m.price,m.id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.stock>10?"bg-green-100 text-green-800":m.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[m.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:m.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>o(m),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>a(m.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},m.id))})]})}),r&&e.jsx(G,{editingProduct:p,setEditingProduct:d,setProducts:i,addNotification:s,setShowProductForm:n,productForm:x,setProductForm:u,handleProductSubmit:c})]})}function Q({setActiveTab:s,activeTab:l,setProducts:i,products:t,formatPrice:a,addNotification:r,setCoupons:n,setSelectedCoupon:o,selectedCoupon:c,coupons:x,deleteProduct:u}){return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>s("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${l==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>s("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${l==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),l==="products"?e.jsx(K,{addNotification:r,formatPrice:a,products:t,setProducts:i,deleteProduct:u}):e.jsx(_,{coupons:x,addNotification:r,setCoupons:n,selectedCoupon:c,setSelectedCoupon:o})]})}function X(s,l){return s.reduce((i,t)=>l>=t.quantity&&t.rate>i?t.rate:i,0)}function Y(s,l){return l?Math.min(s+.05,.5):s}function Z(s,l){const i=X(s.product.discounts,s.quantity);return Y(i,l)}const T=(s,l)=>{const i=l.some(n=>n.quantity>=10),{price:t}=s.product,{quantity:a}=s,r=Z(s,i);return Math.round(t*a*(1-r))},N=(s,l)=>{const i=l.find(a=>a.product.id===s.id);return s.stock-(i?.quantity||0)},k=(s,l)=>{let i=0,t=0;return s.forEach(a=>{const r=a.product.price*a.quantity;i+=r,t+=T(a,s)}),l&&(l.discountType==="amount"?t=Math.max(0,t-l.discountValue):t=Math.round(t*(1-l.discountValue/100))),{totalBeforeDiscount:Math.round(i),totalAfterDiscount:Math.round(t)}};function F({cart:s,removeFromCart:l,updateQuantity:i}){return e.jsx("div",{className:"space-y-3",children:s.map(t=>{const a=T(t,s),r=t.product.price*t.quantity,n=a<r,o=n?Math.round((1-a/r)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:t.product.name}),e.jsx("button",{onClick:()=>l(t.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>i(t.product.id,t.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:t.quantity}),e.jsx("button",{onClick:()=>i(t.product.id,t.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[n&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",o,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(a).toLocaleString(),"원"]})]})]})]},t.product.id)})})}function ee({coupons:s,selectedCoupon:l,setSelectedCoupon:i,applyCoupon:t}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),s.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:l?.code||"",onChange:a=>{const r=s.find(n=>n.code===a.target.value);r?t(r):i(null)},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),s.map(a=>e.jsxs("option",{value:a.code,children:[a.name," (",a.discountType==="amount"?`${a.discountValue.toLocaleString()}원`:`${a.discountValue}%`,")"]},a.code))]})]})}function te(){return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]})}function se({filteredProducts:s,products:l,searchProductName:i,addToCart:t,formatPrice:a,cart:r}){return e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",l.length,"개 상품"]})]}),s.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',i,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(n=>{const o=N(n,r);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),n.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),n.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...n.discounts.map(c=>c.rate))*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:n.name}),n.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:n.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:a(n.price,n.id)}),n.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[n.discounts[0].quantity,"개 이상 구매시 할인"," ",n.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[o<=5&&o>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",o,"개 남음"]}),o>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",o,"개"]})]}),e.jsx("button",{onClick:()=>t(n),disabled:o<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${o<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:o<=0?"품절":"장바구니 담기"})]})]},n.id)})})]})}function re({products:s,filteredProducts:l,searchProductName:i,formatPrice:t,cart:a,coupons:r,selectedCoupon:n,setSelectedCoupon:o,completeOrder:c,setCart:x,addNotification:u,addToCart:d,applyCoupon:p,updateQuantity:m,removeFromCart:g}){const b=k(a,n);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(se,{filteredProducts:l,products:s,searchProductName:i,addToCart:d,formatPrice:t,cart:a})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),a.length===0?e.jsx(te,{}):e.jsx(F,{cart:a,addNotification:u,setCart:x,products:s,updateQuantity:m,removeFromCart:g})]}),a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{coupons:r,selectedCoupon:n,setSelectedCoupon:o,applyCoupon:p}),e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[b.totalBeforeDiscount.toLocaleString(),"원"]})]}),b.totalBeforeDiscount-b.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",(b.totalBeforeDiscount-b.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[b.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs("button",{onClick:c,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[b.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})]})]})})]})}function ne({notifications:s,setNotifications:l}){return e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:s.map(i=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${i.type==="error"?"bg-red-600":i.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:i.message}),e.jsx("button",{onClick:()=>l(t=>t.filter(a=>a.id!==i.id)),className:"text-white hover:text-gray-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},i.id))})}function ae(s,l){const[i,t]=h.useState(()=>{const x=localStorage.getItem("cart");if(x)try{return JSON.parse(x)}catch{return[]}return[]}),[a,r]=h.useState(0),n=h.useCallback(x=>{if(N(x,i)<=0){s("재고가 부족합니다!","error");return}t(d=>{const p=d.find(m=>m.product.id===x.id);if(p){const m=p.quantity+1;return m>x.stock?(s(`재고는 ${x.stock}개까지만 있습니다.`,"error"),d):d.map(g=>g.product.id===x.id?{...g,quantity:m}:g)}return[...d,{product:x,quantity:1}]}),s("장바구니에 담았습니다","success")},[i,s,N]),o=h.useCallback(x=>{t(u=>u.filter(d=>d.product.id!==x))},[]),c=h.useCallback((x,u)=>{if(u<=0){o(x);return}const d=l.find(m=>m.id===x);if(!d)return;const p=d.stock;if(u>p){s(`재고는 ${p}개까지만 있습니다.`,"error");return}t(m=>m.map(g=>g.product.id===x?{...g,quantity:u}:g))},[l,o,s,N]);return h.useEffect(()=>{const x=i.reduce((u,d)=>u+d.quantity,0);r(x)},[i]),h.useEffect(()=>{i.length>0?localStorage.setItem("cart",JSON.stringify(i)):localStorage.removeItem("cart")},[i]),{cart:i,setCart:t,totalItemCount:a,addToCart:n,updateQuantity:c,removeFromCart:o}}function le(s,l){const[i,t]=h.useState(()=>{const c=localStorage.getItem("coupons");if(c)try{return JSON.parse(c)}catch{return M}return M}),[a,r]=h.useState(null);h.useEffect(()=>{localStorage.setItem("coupons",JSON.stringify(i))},[i]);const n=h.useCallback(c=>{if(k(s,a).totalAfterDiscount<1e4&&c.discountType==="percentage"){l("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.","error");return}r(c),l("쿠폰이 적용되었습니다.","success")},[l,k]),o=h.useCallback(c=>{t(x=>x.filter(u=>u.code!==c)),a?.code===c&&r(null),l("쿠폰이 삭제되었습니다.","success")},[a,l]);return{coupons:i,setCoupons:t,setSelectedCoupon:r,selectedCoupon:a,applyCoupon:n,deleteCoupon:o}}function ie(s,l){const[i,t]=h.useState(()=>{try{const a=localStorage.getItem(s);return a?JSON.parse(a):l}catch{return l}});return h.useEffect(()=>{try{localStorage.setItem(s,JSON.stringify(i))}catch{}},[s,i]),[i,t]}function ce(){const[s,l]=ie("products",H);return h.useEffect(()=>{localStorage.setItem("products",JSON.stringify(s))},[s]),{products:s,setProducts:l,deleteProduct:t=>{l(a=>a.filter(r=>r.id!==t))}}}function oe(s,l){if(!l)return s;const i=l.toLowerCase();return s.filter(t=>t.name.toLowerCase().includes(i)||t.description&&t.description.toLowerCase().includes(i))}const de=()=>{const{products:s,setProducts:l,deleteProduct:i}=ce(),[t,a]=h.useState(!1),[r,n]=h.useState([]),[o,c]=h.useState("products"),[x,u]=h.useState(""),[d,p]=h.useState(""),m=(f,v)=>{if(v){const j=s.find(y=>y.id===v);if(j&&N(j,b)<=0)return"SOLD OUT"}return t?`${f.toLocaleString()}원`:`₩${f.toLocaleString()}`},g=h.useCallback((f,v="success")=>{const j=Date.now().toString();n(y=>[...y,{id:j,message:f,type:v}]),setTimeout(()=>{n(y=>y.filter(O=>O.id!==j))},3e3)},[]),{cart:b,setCart:C,totalItemCount:q,addToCart:D,removeFromCart:B,updateQuantity:I}=ae(g,s),{coupons:S,setCoupons:V,selectedCoupon:L,setSelectedCoupon:w,applyCoupon:$}=le(b,g);h.useEffect(()=>{const f=setTimeout(()=>{p(x)},500);return()=>clearTimeout(f)},[x]);const P=h.useCallback(()=>{const f=`ORD-${Date.now()}`;g(`주문이 완료되었습니다. 주문번호: ${f}`,"success"),C([]),w(null)},[g]),E=oe(s,d);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.length>0&&e.jsx(ne,{notifications:r,setNotifications:n}),e.jsx(R,{isAdmin:t,searchTerm:x,setSearchTerm:u,cart:b,totalItemCount:q,setIsAdmin:a}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:t?e.jsx(Q,{setActiveTab:c,activeTab:o,products:s,formatPrice:m,addNotification:g,coupons:S,setProducts:l,setCoupons:V,deleteProduct:i,setSelectedCoupon:w,selectedCoupon:L}):e.jsx(re,{products:s,filteredProducts:E,searchProductName:d,cart:b,formatPrice:m,coupons:S,selectedCoupon:L,setSelectedCoupon:w,completeOrder:P,setCart:C,addNotification:g,addToCart:D,applyCoupon:$,removeFromCart:B,updateQuantity:I})})]})};W.createRoot(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(de,{})}));
